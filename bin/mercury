#!/usr/bin/env ruby

require 'rubygems'
require 'fileutils'

version = ">= 0"

if ARGV.first
  # Build Directory and add setup files
  FileUtils.mkdir_p ARGV.first
  FileUtils.mkdir_p File.join(ARGV.first, 'views')
  config_ru = ["require 'mercury'","log = File.new('mercury.log', 'a+')", "$stdout.reopen(log)", "$stderr.reopen(log)", "run Mercury"].join("\n")
  File.open(File.join(ARGV.first, 'config.ru'),'w').write(config_ru)
else
  puts "Running Mercury on port:9292"
  puts "Press Ctrl-C to exit"
  # try to run in current directory
  gem 'rack', version
  load Gem.bin_path('rack', 'rackup', version)  
end
